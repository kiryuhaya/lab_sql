# lab_sql
Лабораторная работа по УД 3 



ВАРИАНТ 
Уровень 1
1) Дана схема базы данных в виде следующих отношений.  С помощью операторов SQL создать логическую структуру соответствующих таблиц для хранения в СУБД, используя известные средства поддержания целостности (NOT NULL, UNIQUE, и т.д.). Обосновать выбор типов данных и используемые средства поддержания целостности. При выборе подходящих типов данных использовать информацию о конкретных значениях полей БД (см. прил.1)
МЕСТО РАБОТЫ (ИДЕНТИФИКАТОР, НАЗВАНИЕ ОРГ., АДРЕС РАБОТЫ, ЛЬГОТА %) 
АВТОПРЕДПРИЯТИЕ (ИДЕНТИФИКАТОР, НАЗВАНИЕ, РАСПОЛОЖЕНИЕ, КОМИCСИOННЫЕ %) 
ТЕХНИКА (ИДЕНТИФИКАТОР, ТИП, АДРЕС ГАРАЖА, МАКС. КОЛ-ВО, СТОИМОСТЬ ЗАКАЗА РУБ) 
ЗАКАЗ (НОМЕР, ДАТА, МЕСТО РАБОТЫ, АВТО, ПРЕДПРИЯТИЕ, ТЕХНИКА, КОЛ-ВО, ОПЛАТА РУБ)

2) Ввести в ранее созданные таблицы конкретные данные (см. прил. 1). Использовать скрипт-файл из операторов INSERT или вспомогательную утилиту .

3) Используя оператор SELECT создать запрос для вывода всех строк каждой таблицы. Проверить правильность ввода. При необходимости произвести коррекцию значений операторами INSERT, UPDATE, DELETE. 

4) Создать запросы для вывода:
  a)названий всех различных мест работы, вместе с размером льгот;
  b) всех различных адресов, где расположены автопредприятия;
  c) всех различных мест расположения техники.

5) Создать запросы для получения инорфмации о:
  a) типе и месте расположения техники, с максимальным количеством более 3;
  b) автопредприятиях с размером комиссионных более 5% и расположенных не в Н.Новгроде. Вывести также и размер комиссионных. Отсортировать по нему полученные результаты;
  c) местах работы, расположенных в Ильино.
6) Для каждого заказа вывести следующие данные:
  a) название места работы,  техника, количество, оплата. Отсортировать по сумме оплаты и месту работы;
  b) номер, дату, название автопредприятия.

7) Вывести:
  a) названия автопредприятий, которые предоставляли технику на работу в другие населенные пункты для организаций с размером льгот от 3% и выше. Также включить в отчет названия этих организаций и место их расположения;
  b) идентификатор и тип машин, расположенных в том же месте, что и автопредприятие, направившее их на работу;
  c) тип машин, имеющих общих владельцев ( т.е. направленных на работу разными автопредприятиями) и имеющих стоимость заказа более 115000руб.
  d) название мест работы, для которых производился заказ техники на общую сумму более 100000руб.

8) Создать запрос для модификации всех значений столбца с суммарной величиной оплаты таблицы заказ, чтобы он содержал истинную сумму, оплачиваемую организацией-заказчиком ( с учетом льгот). Вывести новые значения.

9) Расширить таблицу с данными о азаказах столбцом, содержащим величину взимаемых комиссионых. Создать запрос для ввода конкретных значений во все строки таблицы заказов.

Уровень 2
10) Используя операцию IN (NOT IN)  реализовать следующие запросы:
  a) определить такие места работы, в которых не работала техника, размещенная в Н.Новгороде;
  b) найти технику которую предоставляли автопредприятия с другим адресом и не бравшие заказы на работу в детском саду;
  c) запрос задания 7.а и 7.b.

11) Используя операции ALL-ANY реализовать следующие запросы:
  a) найти среди автопредприятий, имевших заказы в четверг, автопредприятия с минимальным рамером комиссионных;
  b) определить максимальную стоимость заказов во вторник;
  c) запрос задания 7.с;
  d) найти места работы, имеющие минимальный размер льгот.

12) Используя операцию UNION получить адреса мест работ и адреса размещения техники.

13) Используя операцию EXISTS ( NOT EXISTS ) реализовать нижеследующие запросы. В случае, если для текущего состояния БД запрос будет выдавать пустое множество строк, требуется указать какие добавления в БД необходимо провести.
  a) найти места работы на которые направлялась вся техника не из Н.Новгорода;
  b) определить такие автопредприятия, кторые не получали заказов на поставку автокранов;
  c) найти технику, которую направляли на все такие места работы, которые не делали заказов техники автопредприятиям чужих районов;
  d) какие типы техники направлялись на овощную базу всеми автопредприятиями не более раза.

14) Реализовать запросы с использованием аггрегатных функций:
  a) определить число рзличных видов техники, работавшей в детском саду;
  b) найти среднее значение льгот у тех организаций, которые заказывали технику у всех автопредприятий Н.Новгорода;
  c)найти суммарные расходы овощной базы на заказы автотехники;
  d) найти среди автопредприятий с рпзмером комиссионных больше среднего те, которые предоставляли технику в организации Н.Новгрода.

15) Используя средства группировки реализовать следующие запросы:
  a) найти такие типпы техники, для которых суммарная стоимость заказов за день не превысила 500000;
  b) для каждого автопредприятия вывести общее число его заказов со стоиомостью более 200000;
  c) для каждой организации, в которой работала автотехника, вывести суммарную величину расходов на автотехнику по дням недели;
  d) определить те дни, когда количество заказов от организаций не из Н.новгорода превышало три.


